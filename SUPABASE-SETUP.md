# ğŸ¯ Supabase æ•°æ®åº“é›†æˆå®Œæˆ

æˆ‘å·²ç»ä¸ºä½ çš„ HR SaaS ç³»ç»Ÿåˆ›å»ºäº†å®Œæ•´çš„ Supabase æ•°æ®åº“æ¶æ„å’Œé›†æˆæ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯å·²åˆ›å»ºçš„æ–‡ä»¶ç»“æ„ï¼š

## ğŸ“ æ–‡ä»¶ç»“æ„

```
hr/
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ supabase-schema.sql              # å®Œæ•´çš„æ•°æ®åº“ schema
â”‚   â”œâ”€â”€ ER-diagram-description.md        # å®ä½“å…³ç³»å›¾è¯´æ˜
â”‚   â””â”€â”€ supabase-integration-guide.md    # è¯¦ç»†é›†æˆæŒ‡å—
â”œâ”€â”€ lib/supabase/
â”‚   â”œâ”€â”€ client.ts                        # å®¢æˆ·ç«¯è¿æ¥é…ç½®
â”‚   â”œâ”€â”€ server.ts                        # æœåŠ¡ç«¯è¿æ¥é…ç½®
â”‚   â””â”€â”€ types.ts                         # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ .env.example                         # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ package.json                         # å·²æ·»åŠ  Supabase ä¾èµ–
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»º Supabase é¡¹ç›®
1. è®¿é—® [Supabase Dashboard](https://app.supabase.com)
2. åˆ›å»ºæ–°é¡¹ç›®
3. è®°å½•é¡¹ç›® URL å’Œ API å¯†é’¥

### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env.local

# ç¼–è¾‘ .env.local æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ Supabase é…ç½®ï¼š
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
```

### 3. å®‰è£…ä¾èµ–
```bash
npm install --legacy-peer-deps
```

### 4. æ‰§è¡Œæ•°æ®åº“è¿ç§»
é€‰æ‹©ä»¥ä¸‹ä»»ä¸€æ–¹å¼æ‰§è¡Œ SQL schemaï¼š

**æ–¹å¼ 1: Supabase Dashboardï¼ˆæ¨èï¼‰**
1. æ‰“å¼€ Supabase Dashboard â†’ SQL Editor
2. å¤åˆ¶ `database/supabase-schema.sql` å†…å®¹
3. ç²˜è´´å¹¶æ‰§è¡Œ

**æ–¹å¼ 2: Supabase CLI**
```bash
# å®‰è£… CLI
npm install -g supabase

# ç™»å½•å¹¶é“¾æ¥é¡¹ç›®
supabase login
supabase link --project-ref YOUR_PROJECT_ID

# æ‰§è¡Œè¿ç§»
supabase db push
```

### 5. ç”Ÿæˆç±»å‹å®šä¹‰
```bash
# ç”Ÿæˆæœ€æ–°çš„ TypeScript ç±»å‹
npm run db:generate-types
```

### 6. å¯åŠ¨é¡¹ç›®
```bash
npm run dev
```

## ğŸ“Š æ•°æ®åº“æ¶æ„äº®ç‚¹

### ğŸ¢ å¤šç§Ÿæˆ·æ¶æ„
- åŸºäº `company_id` çš„å®Œå…¨æ•°æ®éš”ç¦»
- è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS) ä¿æŠ¤
- æ”¯æŒä¸åŒè®¢é˜…è®¡åˆ’

### ğŸ‘¥ RBAC æƒé™ç³»ç»Ÿ
- è§’è‰²-æƒé™å¤šå¯¹å¤šæ˜ å°„
- æ¨¡å—åŒ–æƒé™ç®¡ç†
- æ”¯æŒå…¬å¸çº§è‡ªå®šä¹‰è§’è‰²

### ğŸ¯ å®Œæ•´æ‹›è˜æµç¨‹
- éœ€æ±‚ â†’ èŒä½ â†’ ç”³è¯· â†’ é¢è¯• â†’ å½•ç”¨
- AI ç®€å†åˆ†æå’Œé¢è¯•è¾…åŠ©
- çŠ¶æ€è·Ÿè¸ªå’Œæµç¨‹ç®¡ç†

### ğŸ¤– AI å¢å¼ºåŠŸèƒ½
- AI ç®€å†åˆ†æå’ŒæŠ€èƒ½æå–
- æ™ºèƒ½é¢è¯•é—®é¢˜ç”Ÿæˆ
- é¢è¯•è¡¨ç°è¯„ä¼°

### ğŸ‘¨â€ğŸ’¼ å‘˜å·¥å…¨ç”Ÿå‘½å‘¨æœŸ
- å…¥èŒåˆ°ç¦»èŒå®Œæ•´æµç¨‹
- è€ƒå‹¤å’Œè¯·å‡ç®¡ç†
- ç»„ç»‡æ¶æ„å’Œå±‚çº§å…³ç³»

### ğŸ“ˆ ç³»ç»Ÿç›‘æ§
- å®Œæ•´çš„æ“ä½œå®¡è®¡æ—¥å¿—
- é€šçŸ¥ç³»ç»Ÿ
- æ€§èƒ½ä¼˜åŒ–ç´¢å¼•

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

| æ¨¡å— | è¡¨æ•°é‡ | ä¸»è¦åŠŸèƒ½ |
|------|--------|----------|
| **æ ¸å¿ƒç³»ç»Ÿ** | 4 | å¤šç§Ÿæˆ·ã€ç”¨æˆ·ã€è§’è‰²æƒé™ |
| **ç»„ç»‡æ¶æ„** | 2 | éƒ¨é—¨ã€èŒä½å±‚çº§ç®¡ç† |
| **æ‹›è˜æ¨¡å—** | 4 | éœ€æ±‚ã€èŒä½ã€å€™é€‰äººã€ç”³è¯· |
| **AI åŠŸèƒ½** | 3 | ç®€å†åˆ†æã€é¢è¯•é¢˜ã€é¢è¯•è®°å½• |
| **å‘˜å·¥ç®¡ç†** | 2 | å‘˜å·¥æ¡£æ¡ˆã€é›‡ä½£å†å² |
| **è€ƒå‹¤ç®¡ç†** | 3 | æ‰“å¡ã€è¯·å‡ã€å‡æœŸä½™é¢ |
| **ç³»ç»Ÿæ”¯æ’‘** | 2 | æ—¥å¿—ã€é€šçŸ¥ |

## ğŸ” å®‰å…¨ç‰¹æ€§

- âœ… Row Level Security (RLS)
- âœ… å¤šç§Ÿæˆ·æ•°æ®éš”ç¦»
- âœ… API å¯†é’¥åˆ†ç¦»ï¼ˆå®¢æˆ·ç«¯/æœåŠ¡ç«¯ï¼‰
- âœ… æ“ä½œå®¡è®¡æ—¥å¿—
- âœ… è¾“å…¥éªŒè¯å’Œç±»å‹å®‰å…¨

## ğŸ“š éœ€è¦çš„å¯†é’¥ä¿¡æ¯

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ä»¥å®Œæˆé›†æˆï¼š

1. **Supabase é¡¹ç›® URL** - åœ¨ Dashboard â†’ Settings â†’ API
2. **Anon Key** - ç”¨äºå®¢æˆ·ç«¯è®¤è¯
3. **Service Role Key** - ç”¨äºæœåŠ¡ç«¯æ“ä½œ
4. **æ•°æ®åº“å¯†ç ** - åˆ›å»ºé¡¹ç›®æ—¶è®¾ç½®

## ğŸ”„ ä¸‹ä¸€æ­¥

1. **è®¾ç½® Supabase é¡¹ç›®** - åˆ›å»ºè´¦å·å’Œé¡¹ç›®
2. **æ‰§è¡Œæ•°æ®åº“è¿ç§»** - è¿è¡Œ SQL schema
3. **é…ç½®ç¯å¢ƒå˜é‡** - è®¾ç½®è¿æ¥ä¿¡æ¯
4. **æµ‹è¯•è¿æ¥** - éªŒè¯æ•°æ®åº“æ“ä½œ
5. **é›†æˆè®¤è¯** - æ›´æ–°ç™»å½•ç³»ç»Ÿä½¿ç”¨ Supabase Auth

æ‰€æœ‰æ–‡ä»¶éƒ½å·²å‡†å¤‡å°±ç»ªï¼æŒ‰ç…§ `database/supabase-integration-guide.md` ä¸­çš„è¯¦ç»†è¯´æ˜è¿›è¡Œé…ç½®å³å¯ã€‚